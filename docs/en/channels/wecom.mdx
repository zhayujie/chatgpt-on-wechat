---
title: WeCom
description: Integrate CowAgent into WeCom enterprise app
---

Integrate CowAgent into WeCom through a custom enterprise app, supporting one-on-one chat for internal employees.

<Note>
  WeCom only supports Docker deployment or server Python deployment. Local run mode is not supported.
</Note>

## 1. Prerequisites

Required resources:

1. A server with public IP
2. A registered WeCom account (individual registration is possible, but cannot be certified)
3. Certified WeCom requires a domain with corresponding entity filing

## 2. Create WeCom App

1. Get **Corp ID** from **My Enterprise** in [WeCom Admin Console](https://work.weixin.qq.com/wework_admin/frame#profile)
2. Switch to **Application Management**, click Create Application, record `AgentId` and `Secret`
3. Click **Set API Reception**, configure application interface:
   - URL format: `http://ip:port/wxcomapp` (certified enterprises must use filed domain)
   - Generate random `Token` and `EncodingAESKey` and save

## 3. Configuration and Run

```json
{
  "channel_type": "wechatcom_app",
  "wechatcom_corp_id": "YOUR_CORP_ID",
  "wechatcomapp_token": "YOUR_TOKEN",
  "wechatcomapp_secret": "YOUR_SECRET",
  "wechatcomapp_agent_id": "YOUR_AGENT_ID",
  "wechatcomapp_aes_key": "YOUR_AES_KEY",
  "wechatcomapp_port": 9898
}
```

| Parameter | Description |
| --- | --- |
| `wechatcom_corp_id` | Corp ID |
| `wechatcomapp_token` | Token from API reception config |
| `wechatcomapp_secret` | App Secret |
| `wechatcomapp_agent_id` | App AgentId |
| `wechatcomapp_aes_key` | EncodingAESKey from API reception config |
| `wechatcomapp_port` | Listen port, default 9898 |

After starting the program, return to WeCom Admin Console to save **Message Server Configuration**, and add the server IP to **Enterprise Trusted IPs**.

<Warning>
  If configuration fails: 1. Ensure firewall and security group allow the port; 2. Verify all parameters are consistent; 3. Certified enterprises must configure a filed domain.
</Warning>

## 4. Usage

Search for the app name in WeCom to start chatting. To allow external WeChat users, share the invite QR code from **My Enterprise â†’ WeChat Plugin**.
