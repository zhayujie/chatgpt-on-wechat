---
title: 企业微信
description: 将 CowAgent 接入企业微信自建应用
---

通过企业微信自建应用接入 CowAgent，支持企业内部人员单聊使用。

<Note>
  企业微信只能使用 Docker 部署或服务器 Python 部署，不支持本地运行模式。
</Note>

## 一、准备

需要的资源：

1. 一台服务器（有公网 IP）
2. 注册一个企业微信（个人也可注册，但无法认证）
3. 认证企业微信还需要对应主体备案的域名

## 二、创建企业微信应用

1. 在 [企业微信管理后台](https://work.weixin.qq.com/wework_admin/frame#profile) **我的企业** 中获取 **企业ID**
2. 切换到 **应用管理**，点击创建应用，记录 `AgentId` 和 `Secret`
3. 点击 **设置API接收**，配置应用接口：
   - URL 格式为 `http://ip:port/wxcomapp`（认证企业需使用备案域名）
   - 随机获取 `Token` 和 `EncodingAESKey` 并保存

## 三、配置和运行

```json
{
  "channel_type": "wechatcom_app",
  "wechatcom_corp_id": "YOUR_CORP_ID",
  "wechatcomapp_token": "YOUR_TOKEN",
  "wechatcomapp_secret": "YOUR_SECRET",
  "wechatcomapp_agent_id": "YOUR_AGENT_ID",
  "wechatcomapp_aes_key": "YOUR_AES_KEY",
  "wechatcomapp_port": 9898
}
```

| 参数 | 说明 |
| --- | --- |
| `wechatcom_corp_id` | 企业 ID |
| `wechatcomapp_token` | API 接收配置中的 Token |
| `wechatcomapp_secret` | 应用的 Secret |
| `wechatcomapp_agent_id` | 应用的 AgentId |
| `wechatcomapp_aes_key` | API 接收配置中的 EncodingAESKey |
| `wechatcomapp_port` | 监听端口，默认 9898 |

启动程序后，回到企业微信后台保存 **消息服务器配置**，并将服务器 IP 添加到 **企业可信IP** 中。

<Warning>
  如遇到配置失败：1. 确保防火墙和安全组已放行端口；2. 检查各参数配置是否一致；3. 认证企业需配置备案域名。
</Warning>

## 四、使用

在企业微信中搜索应用名称即可直接对话。如需让外部微信用户使用，可在 **我的企业 → 微信插件** 中分享邀请关注二维码。
